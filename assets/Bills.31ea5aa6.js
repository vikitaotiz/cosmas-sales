import{bA as tl,r as d,c as de,w as Qe,aB as De,bV as Be,bR as $e,bZ as al,h as Ae,bg as sl,g as ol,bB as nl,bW as ul,bO as il,c3 as rl,c8 as dl,j as cl,aJ as i,a6 as P,u as q,Q as r,a4 as b,bb as s,d as t,bE as f,bD as qe,a7 as o,N as _e,ad as c,a5 as w,F as Ee,aP as Me,bd as fe,bw as Ne,aM as ml,aK as _l}from"./index.821cda5b.js";import{Q as pe}from"./QBtnGroup.4e978e23.js";import{Q as te}from"./QInput.a5a89d7c.js";import{Q as fl,c as ve,d as U,e as Oe,f as xe}from"./QCardActions.b2c7ab83.js";import{w as pl,a as vl,u as bl,x as Le,y as gl,b as yl,m as hl,d as wl,n as kl,z as Cl,A as ql,e as xl,o as Pl,B as Ue,C as Sl,c as Ie,D as He,E as Vl,F as Tl,G as Ql,l as Fe,j as ze,k as M}from"./rtl.c7eeb6d0.js";import{a as be,Q as ae}from"./QBadge.5b8c22c0.js";import{Q as ie}from"./QSeparator.cb706664.js";import{Q as K,a as re}from"./QCard.6389e115.js";import{a as Dl}from"./use-quasar.5cb60a47.js";import{a as Bl,u as Pe,b as $l}from"./index.96eab636.js";import{u as Al}from"./sale-store.8d453813.js";import{u as El}from"./product-store.cfda362e.js";import{u as Ml}from"./payment-mode-store.baba548c.js";import{u as Nl}from"./auth-store.f024e36c.js";import{e as Ol}from"./receipt.d5eec031.js";import{h as ge}from"./helpers.dd8dddcc.js";import"./use-dark.3e9a724f.js";import"./module_calls.52760843.js";import"./_commonjsHelpers.6150b38b.js";var Se=tl({name:"QTooltip",inheritAttrs:!1,props:{...pl,...vl,...bl,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Le},self:{type:String,default:"top middle",validator:Le},offset:{type:Array,default:()=>[14,14],validator:gl},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...yl],setup(u,{slots:v,emit:g,attrs:S}){let B,j;const J=ol(),{proxy:{$q:m}}=J,W=d(null),I=d(!1),se=de(()=>He(u.anchor,m.lang.rtl)),H=de(()=>He(u.self,m.lang.rtl)),ye=de(()=>u.persistent!==!0),{registerTick:he,removeTick:$}=hl(),{registerTimeout:_}=wl(),{transitionProps:Z,transitionStyle:F}=kl(u),{localScrollTarget:z,changeScrollEvent:G,unconfigureScrollTarget:T}=Cl(u,me),{anchorEl:y,canShow:oe,anchorEvents:N}=ql({showing:I,configureAnchorEl:ke}),{show:X,hide:x}=xl({showing:I,canShow:oe,handleShow:R,handleHide:O,hideOnRouteChange:ye,processOnMount:!0});Object.assign(N,{delayShow:we,delayHide:ce});const{showPortal:p,hidePortal:k,renderPortal:Q}=Pl(J,W,ne,"tooltip");if(m.platform.is.mobile===!0){const h={anchorEl:y,innerRef:W,onClickOutside(L){return x(L),L.target.classList.contains("q-dialog__backdrop")&&ul(L),!0}},ue=de(()=>u.modelValue===null&&u.persistent!==!0&&I.value===!0);Qe(ue,L=>{(L===!0?Vl:Ue)(h)}),De(()=>{Ue(h)})}function R(h){p(),he(()=>{j=new MutationObserver(()=>A()),j.observe(W.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),A(),me()}),B===void 0&&(B=Qe(()=>m.screen.width+"|"+m.screen.height+"|"+u.self+"|"+u.anchor+"|"+m.lang.rtl,A)),_(()=>{p(!0),g("show",h)},u.transitionDuration)}function O(h){$(),k(),ee(),_(()=>{k(!0),g("hide",h)},u.transitionDuration)}function ee(){j!==void 0&&(j.disconnect(),j=void 0),B!==void 0&&(B(),B=void 0),T(),Be(N,"tooltipTemp")}function A(){Sl({targetEl:W.value,offset:u.offset,anchorEl:y.value,anchorOrigin:se.value,selfOrigin:H.value,maxHeight:u.maxHeight,maxWidth:u.maxWidth})}function we(h){if(m.platform.is.mobile===!0){Ie(),document.body.classList.add("non-selectable");const ue=y.value,L=["touchmove","touchcancel","touchend","click"].map(Y=>[ue,Y,"delayHide","passiveCapture"]);$e(N,"tooltipTemp",L)}_(()=>{X(h)},u.delay)}function ce(h){m.platform.is.mobile===!0&&(Be(N,"tooltipTemp"),Ie(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),_(()=>{x(h)},u.hideDelay)}function ke(){if(u.noParentEvent===!0||y.value===null)return;const h=m.platform.is.mobile===!0?[[y.value,"touchstart","delayShow","passive"]]:[[y.value,"mouseenter","delayShow","passive"],[y.value,"mouseleave","delayHide","passive"]];$e(N,"anchor",h)}function me(){if(y.value!==null||u.scrollTarget!==void 0){z.value=al(y.value,u.scrollTarget);const h=u.noParentEvent===!0?A:x;G(z.value,h)}}function Ce(){return I.value===!0?Ae("div",{...S,ref:W,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",S.class],style:[S.style,F.value],role:"tooltip"},nl(v.default)):null}function ne(){return Ae(sl,Z.value,Ce)}return De(ee),Object.assign(J.proxy,{updatePosition:A}),Q}});function Re(u){if(u===!1)return 0;if(u===!0||u===void 0)return 1;const v=parseInt(u,10);return isNaN(v)?0:v}var Ke=il({name:"close-popup",beforeMount(u,{value:v}){const g={depth:Re(v),handler(S){g.depth!==0&&setTimeout(()=>{const B=Tl(u);B!==void 0&&Ql(B,S,g.depth)})},handlerKey(S){rl(S,13)===!0&&g.handler(S)}};u.__qclosepopup=g,u.addEventListener("click",g.handler),u.addEventListener("keyup",g.handlerKey)},updated(u,{value:v,oldValue:g}){v!==g&&(u.__qclosepopup.depth=Re(v))},beforeUnmount(u){const v=u.__qclosepopup;u.removeEventListener("click",v.handler),u.removeEventListener("keyup",v.handlerKey),delete u.__qclosepopup}});const V=u=>(ml("data-v-79458514"),u=u(),_l(),u),Ll={class:"q-pa-md"},Ul={key:0},Il={key:1},Hl={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Fl={key:1,class:"text-center"},zl={class:"text-center"},Rl=V(()=>o("br",null,null,-1)),Kl=V(()=>o("br",null,null,-1)),jl=V(()=>o("br",null,null,-1)),Wl={key:0},Gl=V(()=>o("br",null,null,-1)),Yl={key:1},Jl={key:2},Zl=V(()=>o("hr",null,null,-1)),Xl=V(()=>o("b",null,"Add Product",-1)),et={key:0},lt=V(()=>o("br",null,null,-1)),tt=V(()=>o("hr",null,null,-1)),at={class:"text-center error_msg"},st=V(()=>o("div",{class:"text-h6"},"Make Payment",-1)),ot={class:"q-mt-sm"},nt={key:2,class:"q-pa-sm"},ut={class:"row q-col-gutter-sm"},it={key:3,class:"q-pa-sm"},rt={class:"text-center error_msg"},dt={border:"1",style:{width:"100%","border-collapse":"collapse"}},ct=V(()=>o("tr",null,[o("th",{class:"text-center q-pa-sm"},"Amount Paid"),o("th",{class:"text-center q-pa-sm"},"Balance"),o("th",{class:"text-center q-pa-sm"},"Mode"),o("th",{class:"text-center q-pa-sm"},"Cleared By"),o("th",{class:"text-center q-pa-sm"},"Cleared On")],-1)),mt={class:"text-center q-pa-sm"},_t={class:"text-center q-pa-sm"},ft={class:"text-center q-pa-sm"},pt={class:"text-center q-pa-sm"},vt={class:"text-center q-pa-sm"},bt=V(()=>o("div",{class:"text-center q-ma-sm"},[o("b",null,"Date Picker")],-1)),gt=["max"],yt=V(()=>o("br",null,null,-1)),ht={key:0},wt=["max"],kt={__name:"Bills",setup(u){const v=Bl(),g=Dl(),S=Nl(),B=d("2019/03/01"),j=d("2019/03/01"),J=new Date().toISOString().split("T")[0],m=cl({from:"",to:""}),W=()=>{I.value=!0},I=d(!1),se=d(""),H=Al(),ye=El(),he=Ml(),$=d(!1),_=d(!1),Z=d(!1),F=d(""),z=d(!0),G=d(!1),T=d(1),y=d(1),oe=d(1),N=d(1),X=d(""),x=d(""),p=d(""),k=d(""),Q=d(""),R=d([]),O=d([]),ee=d("");g.loading.show({message:"Please Wait. Fetching today's bills",boxClass:"bg-primary text-white",spinnerColor:"white"});const A=d([]),{isLoading:we,isError:ce}=Pe("bills",()=>H.fetchBills(),{onSuccess:a=>{g.loading.hide(),ee.value=`(Today). ${a==null?void 0:a.length} Records`,O.value=a.map(l=>({user:l.user,uuid:l.uuid,bill_ref:l.bill_ref,debtor_name:l.debtor_name,total_debt_paid:l.total_debt_paid,debt_records:l.debt_records,status:l.status,payment_mode:l.payment_mode,selling_price:l.selling_price,actual_selling_price:l.actual_selling_price,created_at:l.created_at,sales:l.sales})),A.value=O.value}}),ke=()=>{B.value=j.value;const a={from:m.from,to:m.to};me(a),g.loading.show({message:`Please Wait. Fetching data between ${m.from} - ${m.to}`,boxClass:"bg-indigo text-white",spinnerColor:"white"})},{mutate:me}=$l(a=>H.fetchBillsInDateRange(a),{onSuccess:a=>{var l,e;ee.value=`(From:${m.from} - To: ${m.to}). ${(l=a==null?void 0:a.data)==null?void 0:l.length} Records.`,g.loading.hide(),O.value=(e=a==null?void 0:a.data)==null?void 0:e.map(n=>({user:n.user,uuid:n.uuid,bill_ref:n.bill_ref,debtor_name:n.debtor_name,total_debt_paid:n.total_debt_paid,debt_records:n.debt_records,status:n.status,payment_mode:n.payment_mode,selling_price:n.selling_price,actual_selling_price:n.actual_selling_price,created_at:n.created_at,sales:n.sales})),A.value=O.value}});Pe("products",()=>ye.fetchProducts(),{onSuccess:a=>{R.value=a.map(l=>({uuid:l.uuid,name:l.name,price:l.selling_price,category:l.category,department:l.department,quantity:l.quantity}))}});const{data:Ce}=Pe("payment_modes",()=>he.fetchPaymentModes()),ne=d(R.value),h=a=>{x.value=a,$.value=!0},ue=a=>{F.value=a,Z.value=!0},L=()=>{F.value="",Z.value=!1},Y=de(()=>{let a=0;return x.value.sales.forEach(l=>{a+=l.selling_price*l.quantity}),a}),je=a=>{x.value=a,G.value=!0},We=()=>{Q.value="",$.value=!1,p.value="",T.value=1,Q.value=""},Ge=async()=>{if(_.value=!0,T.value>p.value.quantity)Q.value=`${T.value} is more than the maximum available quantity`,E(`${T.value} is more than the maximum available quantity`,"red","top");else{const a=await H.addProductToBill({bill_uuid:x.value.uuid,uuid:p.value.uuid,name:p.value.name,selling_price:p.value.price,quantity:T.value,product_uuid:p.value.uuid});a.status=="success"?(v.refetchQueries("bills"),x.value="",$.value=!1,_.value=!1,E(a.message,"green","top")):(_.value=!1,x.value="",$.value=!1,E(a.message,"red","top"))}},Ye=()=>{G.value=!1,k.value="",Q.value=""},Je=async a=>{if(_.value=!0,confirm("Are you sure?")){const e=await H.removeProductFromBill({product_uuid:a.uuid,product_name:a.name,quantity:a.quantity});e.status=="success"?(v.refetchQueries("bills"),_.value=!1,E(e.message,"green","top")):(x.value="",_.value=!1,$.value=!1,E(e.message,"red","top"))}},Ze=async a=>{if(_.value=!0,confirm("Are you sure?")){const e=await H.deleteBill({bill_uuid:a.uuid});e.status=="success"?(v.refetchQueries("bills"),_.value=!1,E(e.message,"green","top")):(_.value=!1,x.value="",$.value=!1,E(e.message,"red","top"))}},Xe=async()=>{_.value=!0;let a=[];x.value.sales.forEach(e=>a.push({name:e.name,quantity:e.quantity,uuid:e.uuid}));const l={bill_uuid:x.value.uuid,products:a,payment_mode_uuid:k.value.uuid,bill_status:"sold",debtor_name:X.value.trim()};if(k.value.name==="Mpesa & Cash"){const e=Number(oe.value)+Number(N.value);l.selling_price=e,l.actual_selling_price=e}else z.value?(l.selling_price=Number(Y.value),l.actual_selling_price=Number(Y.value)):(l.selling_price=Number(Y.value),l.actual_selling_price=Number(y.value));if(l.actual_selling_price&&l.payment_mode_uuid)if(k.value.name==="Debt"&&!X.value)alert("Debtor name is required."),Q.value="Debtor name is required.",_.value=!1;else{const e=await H.updateSaleOperation(l);e.status==="success"?(v.refetchQueries("bills"),k.value="",T.value="",G.value=!1,_.value=!1,E(e.message,"green","top")):(Q.value=e.message,E(e.message,"red","top-right"))}else _.value=!1,Q.value="Name is required!",E("Name is required!","red","top-right")},el=(a,l)=>{a.length>0&&(R.value.includes(a)||R.value.push(a),l(a,"toggle"))},ll=(a,l)=>{l(()=>{if(a==="")ne.value=R.value;else{const e=a.toLowerCase();ne.value=R.value.filter(n=>n.name.toLowerCase().indexOf(e)>-1)}})},Ve=a=>{const l=[];a.sales.forEach(n=>{l.push({name:n.name,quantity:n.quantity,price:n.selling_price,total:n.quantity*n.selling_price})});const e={title:"Sales Receipt",bill_ref:a.bill_ref,created_at:a.created_at,status:a.status==="sold"?"Sold":"Pending Payment",user:a.user,payment_mode:a.payment_mode,actual_selling_price:a.actual_selling_price,debtor_name:a.debtor_name};Ol(l,["name","quantity","price","total"],e)},E=(a,l,e)=>{g.notify({message:a,color:l,position:e})};return(a,l)=>(i(),P("div",Ll,[q(we)?(i(),P("div",Ul,"Loading bills...")):q(ce)?(i(),P("div",Il,"An error has occurred: "+r(q(ce)),1)):(i(),b(fl,{key:2,grid:"",flat:"",bordered:"",title:`Sold/Pending Bills ${ee.value}`,rows:O.value,"row-key":"bill_ref",filter:se.value},{"top-right":s(()=>[t(pe,{class:"q-mr-sm q-mb-sm"},{default:s(()=>[t(f,{icon:"list",size:"sm",color:"primary",label:"All Bills",onClick:l[0]||(l[0]=()=>q(v).refetchQueries("bills"))}),t(f,{icon:"timeline",size:"sm",color:"blue",label:"Sold Bills",onClick:l[1]||(l[1]=e=>{var n;return O.value=(n=A.value)==null?void 0:n.filter(C=>C.status==="sold")})}),t(f,{icon:"pan_tool",size:"sm",color:"brown",label:"Pending Bills",onClick:l[2]||(l[2]=e=>{var n;return O.value=(n=A.value)==null?void 0:n.filter(C=>C.status==="pending")})}),t(f,{icon:"pan_tool",size:"sm",color:"orange",label:"Clear Bills",to:"/clear_bills"}),t(f,{icon:"event",size:"sm",color:"indigo",label:"Calendar (Older Bills)",onClick:l[3]||(l[3]=e=>W())})]),_:1}),t(te,{dense:"",debounce:"300",outlined:"",modelValue:se.value,"onUpdate:modelValue":l[4]||(l[4]=e=>se.value=e),placeholder:"Search"},{append:s(()=>[t(qe,{name:"search"})]),_:1},8,["modelValue"])]),item:s(e=>[o("div",Hl,[t(re,{bordered:"",class:_e(`${e.row.status=="pending"?"sale_pending":""}`)},{default:s(()=>[o("div",{class:_e(["text-center q-pa-xs",`${e.row.payment_mode==="Debt"?"debt_bill":"bill"}`])},[o("small",null,[o("strong",null,[t(qe,{name:"description",style:{"margin-bottom":"2px"}}),c(" BILL-"+r(e.row.bill_ref),1)])])],2),t(K,{style:{padding:"2px"}},{default:s(()=>[e.row.status==="pending"?(i(),b(be,{key:0},{default:s(()=>[o("strong",null," Created by : "+r(e.row.user),1),t(U),t(pe,{flat:""},{default:s(()=>{var n,C,D;return[t(f,{outline:"",rounded:"",size:"sm",color:"blue",icon:"add",onClick:le=>h(e.row)},{default:s(()=>[t(Se,null,{default:s(()=>[c(" Add More Items to this bill. ")]),_:1})]),_:2},1032,["onClick"]),q(ge)((D=(C=(n=q(S))==null?void 0:n.user)==null?void 0:C.user)==null?void 0:D.roles)?(i(),b(f,{key:0,size:"sm",outline:"",rounded:"",color:"red",icon:"delete",onClick:le=>Ze(e.row),loading:_.value},{default:s(()=>[t(Se,null,{default:s(()=>[c(" Delete this bill ")]),_:1})]),_:2},1032,["onClick","loading"])):w("",!0)]}),_:2},1024)]),_:2},1024)):(i(),P("div",Fl,[o("strong",null," Created by : "+r(e.row.user),1),t(U)])),t(ie,{class:"q-mb-sm"}),o("div",zl,[o("small",null,"Created On : "+r(e.row.created_at),1),c(),Rl,o("small",null,[e.row.payment_mode==="Debt"?(i(),b(ae,{key:0,color:"blue"},{default:s(()=>[c("Status : "+r(e.row.status)+" ",1),Kl,c(" Mode : "+r(e.row.payment_mode),1)]),_:2},1024)):(i(),b(ae,{key:1,color:`${e.row.status=="pending"?"red":""}`},{default:s(()=>[c("Status : "+r(e.row.status)+" ",1),jl,c(" Mode : "+r(e.row.payment_mode),1)]),_:2},1032,["color"]))])]),t(ie,{class:"q-mb-sm"}),o("small",null,[t(Fe,{dense:"",bordered:"",separator:"",class:_e(`${e.row.payment_mode==="Debt"?"debt_bill":"bill"}`)},{default:s(()=>[t(ze,null,{default:s(()=>{var n,C,D;return[t(M,null,{default:s(()=>[c("Name")]),_:1}),t(M,null,{default:s(()=>[c("Price")]),_:1}),t(M,{style:{color:"white"}},{default:s(()=>[c("Quantity")]),_:1}),t(M,{style:{color:"white"}},{default:s(()=>[c("Total")]),_:1}),q(ge)((D=(C=(n=q(S))==null?void 0:n.user)==null?void 0:C.user)==null?void 0:D.roles)&&e.row.status==="pending"&&e.row.sales.length>1?(i(),b(M,{key:0},{default:s(()=>[c("Action")]),_:1})):w("",!0)]}),_:2},1024)]),_:2},1032,["class"])]),o("small",null,[t(Fe,{dense:"",bordered:"",separator:""},{default:s(()=>[(i(!0),P(Ee,null,Me(e.row.sales,(n,C)=>(i(),b(ze,{key:C},{default:s(()=>{var D,le,Te;return[t(M,null,{default:s(()=>[c(r(n.name),1)]),_:2},1024),t(M,null,{default:s(()=>[c(r(n.selling_price),1)]),_:2},1024),t(M,null,{default:s(()=>[c(r(n.quantity),1)]),_:2},1024),t(M,null,{default:s(()=>[c(r((n.quantity*n.selling_price).toFixed(2)),1)]),_:2},1024),q(ge)((Te=(le=(D=q(S))==null?void 0:D.user)==null?void 0:le.user)==null?void 0:Te.roles)&&e.row.status==="pending"&&e.row.sales.length>1?(i(),b(M,{key:0},{default:s(()=>[t(qe,{name:"delete",size:"xs",color:"red",onClick:Ct=>Je(n),style:{cursor:"pointer"}},{default:s(()=>[t(Se,null,{default:s(()=>[c(" Return/Remove "+r(n.name)+" from this bill ",1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)):w("",!0)]}),_:2},1024))),128))]),_:2},1024)])]),_:2},1024),t(ie),e.row.selling_price>0?(i(),b(K,{key:0,class:"text-center"},{default:s(()=>{var n;return[e.row.payment_mode==="Debt"?(i(),P("p",Wl,[c(" Debtor: "+r(e.row.debtor_name)+" ",1),Gl,o("b",null,"Amount due Ksh "+r(e.row.selling_price),1)])):(i(),P("b",Yl,"Price Ksh "+r(e.row.selling_price),1)),((n=e.row.debt_records)==null?void 0:n.length)>0?(i(),P("p",Jl,[t(f,{flat:"",size:"sm",label:"Click to View Payment History",color:"orange",onClick:C=>ue(e.row)},null,8,["onClick"])])):w("",!0),Zl]}),_:2},1024)):w("",!0),t(K,{style:{padding:"0"}},{default:s(()=>[e.row.status==="sold"?(i(),b(f,{key:0,class:"full-width",dense:"",flat:"",onClick:n=>Ve(e.row),label:"Print Bill",icon:"print",color:`${e.row.payment_mode==="Debt"?"blue":"primary"}`},null,8,["onClick","color"])):(i(),b(pe,{key:1,class:"full-width"},{default:s(()=>{var n,C,D;return[t(f,{class:"full-width",dense:"",flat:"",onClick:le=>Ve(e.row),label:"Print Bill",icon:"print",color:"primary"},null,8,["onClick"]),q(ge)((D=(C=(n=q(S))==null?void 0:n.user)==null?void 0:C.user)==null?void 0:D.roles)?(i(),b(f,{key:0,dense:"",flat:"",push:"",color:"orange",class:"full-width",label:"Sale",icon:"grain",onClick:le=>je(e.row)},null,8,["onClick"])):w("",!0)]}),_:2},1024))]),_:2},1024)]),_:2},1032,["class"])])]),_:1},8,["title","rows","filter"])),t(ve,{modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=e=>$.value=e),persistent:""},{default:s(()=>[t(re,{style:{width:"500px"}},{default:s(()=>[t(K,null,{default:s(()=>[t(be,null,{default:s(()=>[Xl,t(U),p.value?(i(),P("small",et,[t(ae,{class:"q-mr-sm",color:"blue"},{default:s(()=>[c("Price: "+r(p.value.price),1)]),_:1}),t(ae,{class:"q-mr-sm",color:"blue"},{default:s(()=>[c("Category: "+r(p.value.category),1)]),_:1}),t(ae,{class:"q-mr-sm",color:"blue"},{default:s(()=>[c("Current Qty: "+r(p.value.quantity),1)]),_:1}),lt,t(ae,{class:"q-mr-sm",color:"blue"},{default:s(()=>[c("Department: "+r(p.value.department),1)]),_:1})])):w("",!0)]),_:1}),tt,t(Oe,{dense:"","use-input":"",outlined:"",modelValue:p.value,"onUpdate:modelValue":l[5]||(l[5]=e=>p.value=e),"input-debounce":"0",onNewValue:el,options:ne.value,onFilter:ll,"option-value":"uuid","option-label":"name",label:"Select Product to add",hint:"You can type in the product name for quick search..."},null,8,["modelValue","options"])]),_:1}),t(K,{class:"q-pt-none"},{default:s(()=>[p.value?(i(),b(te,{key:0,outlined:"",dense:"",label:"Product Quantity",modelValue:T.value,"onUpdate:modelValue":l[6]||(l[6]=e=>T.value=e),type:"number",hint:`Note : You can sale a maximum of ${p.value.quantity}`},null,8,["modelValue","hint"])):w("",!0)]),_:1}),o("div",at,[o("small",null,r(Q.value),1)]),t(xe,{align:"right"},{default:s(()=>[t(f,{flat:"",label:"Cancel",color:"red",onClick:We}),t(U),T.value&&p.value?(i(),b(f,{key:0,flat:"",label:"Add Product",color:"primary",onClick:Ge,loading:_.value},null,8,["loading"])):w("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:G.value,"onUpdate:modelValue":l[14]||(l[14]=e=>G.value=e),persistent:""},{default:s(()=>[t(re,{style:{width:"500px"}},{default:s(()=>[t(be,null,{default:s(()=>[st,t(U),o("small",ot,[t(f,{disabled:k.value.name==="Mpesa & Cash",size:"sm",color:"blue",depressed:"",class:_e(`${z.value?"":"actual_selling_price"}`),onClick:l[8]||(l[8]=e=>z.value=!z.value),label:`Expected Selling Price : ${Y.value}`},null,8,["disabled","class","label"])])]),_:1}),t(K,{class:"q-pt-none"},{default:s(()=>[!z.value&&k.value.name!=="Mpesa & Cash"?(i(),b(te,{key:0,autofocus:"",outlined:"",dense:"",label:"Actual Selling Price",modelValue:y.value,"onUpdate:modelValue":l[9]||(l[9]=e=>y.value=e),class:"q-pa-xs col-xs-12 col-sm-6 col-md-6 q-mb-sm",type:"number"},null,8,["modelValue"])):w("",!0),y.value&&y.value>0?(i(),b(Oe,{key:1,dense:"",outlined:"",modelValue:k.value,"onUpdate:modelValue":l[10]||(l[10]=e=>k.value=e),options:q(Ce).filter(e=>e.name!=="Debt"),"option-value":"uuid","option-label":"name",label:"Select Payment Mode"},null,8,["modelValue","options"])):w("",!0),k.value.name==="Mpesa & Cash"?(i(),P("div",nt,[o("div",ut,[t(te,{outlined:"",dense:"",class:"col-6",label:"Mpesa Amount",type:"number",modelValue:oe.value,"onUpdate:modelValue":l[11]||(l[11]=e=>oe.value=e)},null,8,["modelValue"]),t(te,{outlined:"",dense:"",class:"col-6",label:"Cash Amount",type:"number",modelValue:N.value,"onUpdate:modelValue":l[12]||(l[12]=e=>N.value=e)},null,8,["modelValue"])])])):w("",!0),k.value.name==="Debt"?(i(),P("div",it,[t(te,{outlined:"",modelValue:X.value,"onUpdate:modelValue":l[13]||(l[13]=e=>X.value=e),dense:"",label:"Debtor Name"},null,8,["modelValue"])])):w("",!0)]),_:1}),o("div",rt,[o("small",null,r(Q.value),1)]),t(xe,{align:"right"},{default:s(()=>[t(f,{flat:"",label:"Cancel",color:"red",onClick:Ye}),t(U),y.value&&k.value?(i(),b(f,{key:0,flat:"",label:"Sale",color:"primary",onClick:Xe,loading:_.value},null,8,["loading"])):w("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:Z.value,"onUpdate:modelValue":l[16]||(l[16]=e=>Z.value=e),persistent:""},{default:s(()=>[t(re,null,{default:s(()=>[t(be,{class:"bg-orange text-white q-mb-sm"},{default:s(()=>[o("b",null,"Payment History for BILL-"+r(F.value.bill_ref)+". ",1),t(U),o("b",null,"Name: "+r(F.value.debtor_name)+". ",1)]),_:1}),t(K,{class:"q-pt-none"},{default:s(()=>[o("small",null,[o("table",dt,[ct,(i(!0),P(Ee,null,Me(F.value.debt_records,e=>(i(),P("tr",{key:e.uuid},[o("td",mt,r(e.amount_paid),1),o("td",_t,r(e.balance),1),o("td",ft,r(e.payment_mode),1),o("td",pt,r(e.user),1),o("td",vt,r(e.created_at),1)]))),128))])])]),_:1}),t(xe,null,{default:s(()=>[t(f,{dense:"",flat:"",label:`Total Paid: ${F.value.total_debt_paid}`,color:"primary",disabled:""},null,8,["label"]),t(U),t(f,{dense:"",outline:"",label:"Close History",color:"primary",onClick:l[15]||(l[15]=e=>L())})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ve,{modelValue:I.value,"onUpdate:modelValue":l[19]||(l[19]=e=>I.value=e),persistent:""},{default:s(()=>[t(re,{class:"bg-indigo text-white text-center q-pa-sm",style:{width:"210px"}},{default:s(()=>[bt,t(ie,{color:"white"}),t(K,null,{default:s(()=>[o("div",null,[c(" From : "),fe(o("input",{type:"date","onUpdate:modelValue":l[17]||(l[17]=e=>m.from=e),max:q(J)},null,8,gt),[[Ne,m.from]])]),yt,m.from?(i(),P("div",ht,[c(" To : "),fe(o("input",{type:"date","onUpdate:modelValue":l[18]||(l[18]=e=>m.to=e),max:q(J)},null,8,wt),[[Ne,m.to]])])):w("",!0)]),_:1}),t(ie,{color:"yellow"}),t(pe,{flat:"",class:"full-width"},{default:s(()=>[fe(t(f,{dense:"",label:"Cancel",color:"yellow",flat:""},null,512),[[Ke]]),t(U),m.to?fe((i(),b(f,{key:0,dense:"",label:"Fetch Bills",color:"white",flat:"",onClick:ke},null,512)),[[Ke]]):w("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};var Ft=dl(kt,[["__scopeId","data-v-79458514"]]);export{Ft as default};
