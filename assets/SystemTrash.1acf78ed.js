import{bA as se,c as te,h as le,bB as oe,g as ae,co as re,c2 as de,c1 as ne,ca as ce,r as g,j as ie,u as l,aJ as _,a6 as k,d as e,bb as t,a7 as d,Q as x,a5 as Q,bE as r,bD as Y,ad as b,a4 as q,bd as ue,aM as me,aK as _e}from"./index.2bde107a.js";import{Q as C}from"./QSpace.9e0724bd.js";import{Q as pe}from"./QBadge.e812789d.js";import{Q as ve}from"./QToolbar.3aa20603.js";import{u as fe,a as ge,Q as F,b as H}from"./helpers.5b8cfde7.js";import{g as be,Q as he}from"./module_calls.b67ca1a8.js";import{Q as E}from"./QTooltip.f801aa83.js";import{Q as ye}from"./QTd.5d1d3602.js";import{Q as ke}from"./QTable.aea3afe4.js";import{Q as xe}from"./QDialog.68e40b65.js";import{C as Qe}from"./ClosePopup.6deec16c.js";import{u as De}from"./user-store.b7ebab49.js";import{a as Se}from"./use-quasar.dc4235cf.js";import{u as $e}from"./index.6a80c9ab.js";import"./rtl.d38ebc78.js";import"./QList.c5e9bb29.js";import"./use-key-composition.dcc0853f.js";var we=se({name:"QBar",props:{...fe,dense:Boolean},setup(n,{slots:u}){const{proxy:{$q:h}}=ae(),D=ge(n,h),S=te(()=>`q-bar row no-wrap items-center q-bar--${n.dense===!0?"dense":"standard"}  q-bar--${D.value===!0?"dark":"light"}`);return()=>le("div",{class:S.value,role:"toolbar"},oe(u.default))}});const T=re(),W=T==null?void 0:T.token,qe=de("deleted_records",{state:()=>({deleted_records:[]}),actions:{async fetchDeletedRecords(){if(W){const n=await be("deleted_records",W);return this.deleted_records=n,this.deleted_records}}}});const Ce=n=>(me("data-v-31a4e922"),n=n(),_e(),n),Ee={key:0,class:"q-pa-md"},Te=Ce(()=>d("strong",null,"Recycle Bin and Logs",-1)),Be={class:"text-blue text-center q-mb-md"},Re={style:{color:"#017951"}},ze={key:0},Le={key:1,class:"row q-col-gutter-sm q-ml-xs q-mr-sm q-py-sm"},Ie={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},Ue={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},Ve={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},Ae={class:"col-lg-6 col-md-6 col-sm-12 col-xs-12"},Me={key:2},Ne={class:"text-h6"},Pe={class:"my-table-details"},je={__name:"SystemTrash",setup(n){const u=De(),h=ce();u.access_granted||h.push("/settings");const D=Se(),S=qe(),$=g(!1),m=g(!0),p=g([]),c=g([]),f=g(""),v=ie({minutes:0,seconds:0}),X=setInterval(()=>{v.seconds++,v.seconds===59&&(v.minutes++,v.seconds=0)},1e3);setTimeout(()=>{clearInterval(X),B("Your access session has expired. Confirm your credentials to continue","teal","top"),h.push("/settings"),u.access_granted=!1},18e5);const{data:i,isLoading:Z,isError:ee}=$e("deleted_records",()=>S.fetchDeletedRecords(),{onSuccess:o=>c.value=o}),y=o=>{o=="products"&&(f.value=`DELETED PRODUCTS (${c.value.deleted_products.length})`,p.value=c.value.deleted_products),o=="bills"&&(f.value=`DELETED BILLS (${c.value.deleted_bills.length})`,p.value=c.value.deleted_bills),o=="sales"&&(f.value=`DELETED SALES (${c.value.deleted_sales.length})`,p.value=c.value.deleted_sales),o=="users"&&(f.value=`DELETED USERS (${c.value.deleted_users.length})`,p.value=c.value.deleted_users),p.value.length>0?$.value=!0:B(`${o} has no deleted records`,"red","top")},B=(o,s,a)=>{D.notify({type:"negative",message:o,color:s,position:a})};return(o,s)=>l(u).access_granted?(_(),k("div",Ee,[e(F,{dark:"",class:"bg_trash q-ma-md",style:{"border-radius":"20px"}},{default:t(()=>[e(ve,null,{default:t(()=>[e(r,{dense:"",flat:"",icon:"arrow_back",label:"Exit",onClick:s[0]||(s[0]=()=>{l(u).access_granted=!1,o.$router.back()})}),e(C),d("span",null,[e(Y,{name:"delete",size:"xs"}),Te]),e(C),e(pe,{color:"blue",class:"q-pa-sm",rounded:""},{default:t(()=>[b(x(l(u).access_granted?"Access Granted":"Access Denied"),1)]),_:1})]),_:1})]),_:1}),d("div",Be,[d("b",Re," Session expires in: Minutes "+x(v.minutes)+" : Seconds "+x(v.seconds),1)]),e(he,{color:"primary"}),e(H,{class:"q-pt-md"},{default:t(()=>{var a,R,z,L,I,U,V,A,M,N,P,j,G,J,K,O;return[l(Z)?(_(),k("div",ze,"Loading Deleted Records")):(_(),k("div",Le,[d("div",Ie,[e(r,{label:`Products (${(R=(a=l(i))==null?void 0:a.deleted_products)==null?void 0:R.length})`,color:`${((L=(z=l(i))==null?void 0:z.deleted_products)==null?void 0:L.length)>0?"red":"orange"}`,onClick:s[1]||(s[1]=w=>y("products")),rounded:"",class:"full-width",unelevated:"",icon:"list"},null,8,["label","color"])]),d("div",Ue,[e(r,{label:`Bills (${(U=(I=l(i))==null?void 0:I.deleted_bills)==null?void 0:U.length})`,color:`${((A=(V=l(i))==null?void 0:V.deleted_bills)==null?void 0:A.length)>0?"red":"orange"}`,onClick:s[2]||(s[2]=w=>y("bills")),rounded:"",class:"full-width",unelevated:"",icon:"description"},null,8,["label","color"])]),d("div",Ve,[e(r,{label:`Sales (${(N=(M=l(i))==null?void 0:M.deleted_sales)==null?void 0:N.length})`,color:`${((j=(P=l(i))==null?void 0:P.deleted_sales)==null?void 0:j.length)>0?"red":"orange"}`,onClick:s[3]||(s[3]=w=>y("sales")),rounded:"",class:"full-width",unelevated:"",icon:"show_chart"},null,8,["label","color"])]),d("div",Ae,[e(r,{label:`Users (${(J=(G=l(i))==null?void 0:G.deleted_users)==null?void 0:J.length})`,color:`${((O=(K=l(i))==null?void 0:K.deleted_users)==null?void 0:O.length)>0?"red":"orange"}`,onClick:s[4]||(s[4]=w=>y("users")),rounded:"",class:"full-width",unelevated:"",icon:"supervisor_account"},null,8,["label","color"])])])),l(ee)?(_(),k("div",Me,"There was an error")):Q("",!0)]}),_:1}),e(xe,{modelValue:$.value,"onUpdate:modelValue":s[7]||(s[7]=a=>$.value=a),persistent:"",maximized:m.value,"transition-show":"slide-up","transition-hide":"slide-down"},{default:t(()=>[e(F,{class:"text-white bg_trash"},{default:t(()=>[e(we,{class:"q-pa-lg"},{default:t(()=>[d("div",Ne,[e(Y,{name:"delete",size:"sm"}),b(" "+x(f.value),1)]),e(C),e(r,{dense:"",flat:"",icon:"minimize",onClick:s[5]||(s[5]=a=>m.value=!1),disable:!m.value},{default:t(()=>[m.value?(_(),q(E,{key:0,class:"bg-white text-green"},{default:t(()=>[b("Minimize Recycle Bin")]),_:1})):Q("",!0)]),_:1},8,["disable"]),e(r,{dense:"",flat:"",icon:"crop_square",onClick:s[6]||(s[6]=a=>m.value=!0),disable:m.value},{default:t(()=>[m.value?Q("",!0):(_(),q(E,{key:0,class:"bg-white text-green"},{default:t(()=>[b("Maximize Recycle Bin")]),_:1}))]),_:1},8,["disable"]),ue((_(),q(r,{dense:"",flat:"",icon:"close"},{default:t(()=>[e(E,{class:"bg-white text-green"},{default:t(()=>[b("Close Recycle Bin")]),_:1})]),_:1})),[[Qe]])]),_:1}),e(H,{class:"q-pt-none"},{default:t(()=>[e(ke,{flat:"",bordered:"",title:"Records",dense:"",rows:p.value,"row-key":"name",class:"q-mt-md"},{"body-cell-action":t(a=>[e(ye,{props:a},{default:t(()=>[d("div",Pe,[e(r,{flat:"",icon:"settings_backup_restore",color:"primary",size:"sm"}),e(r,{flat:"",icon:"delete",color:"red",size:"sm"})])]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])])):Q("",!0)}};var ds=ne(je,[["__scopeId","data-v-31a4e922"]]);export{ds as default};
